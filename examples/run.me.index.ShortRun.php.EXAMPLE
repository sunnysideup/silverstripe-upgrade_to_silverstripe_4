<?php
require_once __DIR__ . '/vendor/autoload.php';

use Sunnysideup\UpgradeSilverstripe\ModuleUpgrader;

$obj = ModuleUpgrader::create()
    ->setRecipe('SS4') // see: ModuleUpgraderBaseWithVariables::availableRecipes
    ->setAboveWebRootDirLocation('/var/www/upgrades')
    ->setWebRootName('testrun')

    ->setArrayOfModules(
        [
            //see run.me.index.full.php.EXAMPLE for more details1
            1 => [
              'VendorName' => 'myclient',
              'VendorNamespace' => 'MyClient',
              'PackageName' => 'app',
              'PackageNamespace' => 'App',
              'GitLink' => 'git@bitbucket.org:sunnysideupnz/myclient.org.nz.git',
              'IsModuleUpgrade' => true,
            ]
        ]
    )

    ->setNameOfTempBranch('test-only')

    ->setFrameworkComposerRestraint('~3.7')

    ->setListOfTasks(
        [
            'WebRootDirCheckFoldersReady' => [],
            'WebRootDirReset-1' => [],
            'CheckoutDefaultBranch-1' => [],
            'BranchAddUpgradeStarterBranch' => [],
            'LintPSR2' => [],
        ]
    )
    ->run();
